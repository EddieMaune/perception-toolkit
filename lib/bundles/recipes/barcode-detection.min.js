!function(){"use strict";var t;function e(e,n=t.INFO,i){if("undefined"==typeof DEBUG||n>DEBUG)return;const a=function(e,n){let i="";switch(e){case t.WARNING:i="WARNING";break;case t.ERROR:i="ERROR";break;default:i="INFO"}if(!n)return`${i}:`;return`${i} [${n}]:`}(n,i);switch(n){case t.ERROR:console.error(a,e);break;case t.WARNING:console.warn(a,e);break;default:console.log(a,e)}}let n;async function i(i,{context:a=window,forceNewDetector:s=!1,polyfillPrefix:o=""}={}){var r;a!==window||"BarcodeDetector"in a||(e("Native barcode detector unavailable",t.WARNING,"BarcodeDetector"),await(r=`${o}/lib/polyfills/barcode-detector.js`,new Promise((t,e)=>{const n=document.createElement("script");n.src=r,n.onload=t,n.onerror=e,document.head.appendChild(n)}))),n&&!s||(n=new a.BarcodeDetector),"isReady"in n&&await n.isReady;try{return await n.detect(i)}catch(n){return e(`Detection failed: ${n.message}`,t.WARNING),[]}}function a(t,e=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY){return Math.max(e,Math.min(n,t))}function s(t){return 1-Math.pow(1-t,3)}!function(t){t[t.VERBOSE=4]="VERBOSE",t[t.INFO=3]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=1]="ERROR",t[t.NONE=0]="NONE"}(t||(t={}));const o=new WeakMap;const r="\n:host {\n  --baseline: 8px;\n  --background: #FFF;\n  --borderRadius: 4px;\n  --color: #333;\n  --fontFamily: 'Arial', 'Helvetica', sans-serif;\n  --padding: calc(var(--baseline) * 4)\n      calc(var(--baseline) * 4)\n      calc(var(--baseline) * 2)\n      calc(var(--baseline) * 3);\n\n  position: relative;\n  display: inline-block;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  border-radius: var(--borderRadius);\n  font-family: var(--fontFamily);\n  background: var(--background);\n  color: var(--color);\n}\n\n#container {\n  padding: var(--padding);\n  white-space: nowrap;\n}\n\n#close {\n  width: calc(var(--baseline) * 3);\n  height: calc(var(--baseline) * 3);\n  background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=);\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  font-size: 0;\n  border: none;\n  cursor: pointer;\n  opacity: 0.7;\n  transition: opacity 0.3s cubic-bezier(0, 0, 0.3, 1);\n}\n\n#close:hover {\n  opacity: 1;\n}\n\nslot::slotted(*) {\n  flex: 1;\n  border-right: 1px solid #CCC;\n}\n\nslot::slotted(*:last-child) {\n  border-right: none;\n}\n\nslot {\n  display: flex;\n  border-top: 1px solid #AAA;\n}\n\n:host(:empty) slot {\n  border: none;\n}\n",c='\n  <button id="close">Close</button>\n  <div id="container"></div>\n  <div id="slotted-content"><slot></slot></div>\n';class d extends HTMLElement{constructor(){super(),this.fadeDuration=200,this.sandboxAttribute="allow-same-origin",this.srcInternal="",this.root=this.attachShadow({mode:"open"}),this.onClickBound=this.onClick.bind(this)}get src(){return this.srcInternal}set src(t){this.srcInternal=t,this.render()}get width(){return this.widthInternal}set width(t){this.widthInternal=t,this.setDimensions()}get height(){return this.heightInternal}set height(t){this.heightInternal=t,this.setDimensions()}connectedCallback(){this.root.innerHTML=`<style>${r}</style> ${c}`,this.render(),this.setDimensions(),this.addEventListener("click",this.onClickBound)}disconnectedCallback(){this.removeEventListener("click",this.onClickBound)}async close(t=this.fadeDuration){0!==t?(await function(t,{from:e=1,to:n=0,duration:i=250,ease:r=s}={}){return new Promise(s=>{const c=o.get(t);c&&(cancelAnimationFrame(c.id),o.delete(t),c.resolve()),t.style.opacity=e.toString();const d=self.performance.now(),l=()=>{const c=a((self.performance.now()-d)/i,0,1),h=e+(n-e)*r(c);t.style.opacity=h.toString(),c<1?o.set(t,{id:requestAnimationFrame(l),resolve:s}):(t.style.opacity=n.toString(),o.delete(t),s())};o.set(t,{id:requestAnimationFrame(l),resolve:s})})}(this,{duration:t}),this.remove()):this.remove()}async onClick(t){"close"===(t.path?t.path[0]:t.composedPath()[0]).id&&await this.close()}render(){const t=this.root.querySelector("#container");if(t)if(this.srcIsString(this.src))t.textContent=this.src;else if(void 0===this.src)t.textContent="Unexpected content";else{const e=document.createElement("iframe");e.src=this.src.toString(),e.setAttribute("sandbox",this.sandboxAttribute),e.style.border="none",e.id="external-content",e.width=(this.width||0).toString(),e.height=(this.height||0).toString(),t.appendChild(e)}}srcIsString(t){return"string"==typeof t}setDimensions(){const t=this.root.querySelector("#container");t&&(this.widthInternal&&(t.style.width=`${this.widthInternal}px`),this.heightInternal&&(t.style.height=`${this.heightInternal}px`))}}d.defaultTagName="data-card";const l="\n:host {\n  --color: #999;\n  --dotSize: 8px;\n  --dotMargin: 4px;\n  display: flex;\n}\n\n.dot {\n  border-radius: 50%;\n  width: var(--dotSize);\n  height: var(--dotSize);\n  background: var(--color);\n  margin: var(--dotMargin);\n  animation: bounceHorizontal 1s infinite cubic-bezier(0, 0, 0.4, 1);\n}\n\n:host([vertical]) .dot {\n  animation-name: bounceVertical;\n}\n\n.dot:nth-of-type(2) {\n  animation-delay: 0.1s;\n}\n\n.dot:nth-of-type(3) {\n  animation-delay: 0.2s;\n}\n\n.dot:nth-of-type(4) {\n  animation-delay: 0.3s;\n}\n\n@keyframes bounceHorizontal {\n  0% {\n    transform: none;\n  }\n\n  50% {\n    transform: translateX(-10px);\n  }\n\n  100% {\n    transform: none;\n  }\n}\n\n@keyframes bounceVertical {\n  0% {\n    transform: none;\n    animation-timing-function: ease-in;\n  }\n\n  10% {\n    transform: translateY(-4px);\n    animation-timing-function: ease-in-out;\n  }\n\n  30% {\n    transform: translateY(4px);\n    animation-timing-function: ease-out;\n  }\n\n  40% {\n    transform: none;\n  }\n\n  100% {\n    transform: none;\n  }\n}\n",h='\n  <div class="dot"></div>\n  <div class="dot"></div>\n  <div class="dot"></div>\n  <div class="dot"></div>';class u extends HTMLElement{constructor(){super(),this.root=this.attachShadow({mode:"open"})}connectedCallback(){this.root.innerHTML=`<style>${l}</style> ${h}`}}u.defaultTagName="dot-loader";const m="\n:host {\n  --baseline: 8px;\n  --background: #FFF;\n  --borderRadius: 4px;\n  --color: #333;\n  --fontFamily: 'Arial', 'Helvetica', sans-serif;\n  --padding: calc(var(--baseline) * 4)\n      calc(var(--baseline) * 4)\n      calc(var(--baseline) * 2)\n      calc(var(--baseline) * 3);\n\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  max-width: 80vw;\n  text-align: center;\n}\n\n#container {\n  padding: var(--padding);\n  border-radius: var(--borderRadius);\n  font-family: var(--fontFamily);\n  background: var(--background);\n  color: var(--color);\n}\n",v='<div id="container"></div>';class p extends HTMLElement{constructor(){super(),this.message=p.DEFAULT_MESSAGE,this.root=this.attachShadow({mode:"open"})}connectedCallback(){this.root.innerHTML=`<style>${m}</style> ${v}`,this.root.querySelector("#container").textContent=this.message}}function f(t,e=window,n){const i=new CustomEvent(t,{bubbles:!0,detail:n});e.dispatchEvent(i)}p.defaultTagName="no-support-card",p.DEFAULT_MESSAGE="Sorry, this browser does not support the required features";const g="\n:host {\n  position: relative;\n  display: flex;\n}\n\ncanvas {\n  width: 100%;\n  max-width: 100%;\n  max-height: 100%;\n  object-fit: contain;\n  left: 0;\n}\n\n#container {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n",w='<div id="container"></div>';class y extends HTMLElement{constructor(){super(),this.captureScale=.5,this.captureRate=0,this.capturePng=!1,this.flipped=!1,this.root=this.attachShadow({mode:"open"}),this.lastCapture=-1,this.root.innerHTML=`<style>${g}</style> ${w}`}disconnectedCallback(){this.stop()}start(t){if(this.stream)throw new Error("Stream already provided. Stop the capture first.");this.stream=t,this.initElementsIfNecessary();const e=a(this.captureScale,0),n=this.video,i=t=>{this.video&&this.ctx&&(this.ctx.drawImage(this.video,0,0,this.video.videoWidth*e,this.video.videoHeight*e),0!==this.captureRate&&t-this.lastCapture>this.captureRate&&(this.lastCapture=t,this.captureFrame()),requestAnimationFrame(t=>i(t)))};n.muted=!0,n.srcObject=this.stream,n.play(),n.addEventListener("playing",async()=>{if(!this.video||!this.canvas||!this.ctx)return;let t=5,e=!0;for(;e;)t--,await new Promise(t=>requestAnimationFrame(t)),e=t>0&&(0===this.video.videoWidth||0===this.video.videoHeight);if(0===this.video.videoWidth||0===this.video.videoHeight)throw new Error("Video has width or height of 0");this.canvas.width=this.video.videoWidth*this.captureScale,this.canvas.height=this.video.videoHeight*this.captureScale,this.flipped&&(this.ctx.translate(.5*this.canvas.width,0),this.ctx.scale(-1,1),this.ctx.translate(.5*-this.canvas.width,0)),requestAnimationFrame(t=>{i(t),f(y.startEvent,this)})},{once:!0})}async captureFrame(){if(!this.ctx||!this.canvas)throw new Error("Unable to capture frame");return new Promise(t=>{const e=this.canvas,n=this.ctx;let i;this.capturePng?((i=new Image).src=e.toDataURL("image/png"),i.onload=(()=>{0!==this.captureRate&&f(y.frameEvent,this,{imgData:i}),t(i)})):(i=n.getImageData(0,0,e.width,e.height),0!==this.captureRate&&f(y.frameEvent,this,{imgData:i}),t(i))})}stop(){if(!this.stream||!this.ctx||!this.canvas)return;const t=this.stream.getTracks();for(const e of t)e.stop();this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.remove(),this.video=void 0,this.stream=void 0,this.canvas=void 0,this.ctx=void 0,f(y.stopEvent,this)}initElementsIfNecessary(){if(!this.canvas){if(this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),!this.ctx)throw new Error("Unable to create canvas context");const t=this.root.querySelector("#container");if(!t)throw new Error("Template error: unable to find container");t.appendChild(this.canvas)}this.video||(this.video=document.createElement("video"))}}y.defaultTagName="stream-capture",y.frameEvent="captureframe",y.startEvent="capturestarted",y.stopEvent="capturestopped";class b{constructor(){this.useEvents=!1,this.detectors=new Map}addDetector(t){const{name:e,supported:n}=t;if(this.detectors.has(e))throw new Error(`${e} already added`);this.detectors.set(e,n)}removeDetector(t){this.detectors.delete(t)}async detect(){const t={};for(const[e,n]of this.detectors)t[e]=await n();return this.useEvents&&f(b.supportsEvent,self,t),t}}b.supportsEvent="supports";var E,I={name:"getUserMedia",supported:async()=>"mediaDevices"in self.navigator&&"getUserMedia"in self.navigator.mediaDevices};E=t.WARNING,self.DEBUG=E;const x=new Set;let N;function D(){let t=document.querySelector("#container");return t||((t=document.createElement("div")).id="container",document.body.appendChild(t)),t}customElements.define(y.defaultTagName,y),customElements.define(p.defaultTagName,p),customElements.define(d.defaultTagName,d),customElements.define(u.defaultTagName,u),window.addEventListener(b.supportsEvent,async function(t){if(t.detail[I.name])(N=new u).style.setProperty("--color","#FFF"),document.body.appendChild(N),async function(){const t=await navigator.mediaDevices.enumerateDevices(),e=await async function(t){return t.filter(t=>"videoinput"===t.kind).some(t=>{if(!("getCapabilities"in t))return!1;const e=t.getCapabilities();return!!e.facingMode&&e.facingMode.find(t=>"environment")})}(t),n=new y;n.captureRate=600,n.style.width="100%",n.captureScale=.6,n.addEventListener("click",async()=>{try{await n.requestFullscreen()}catch(t){console.warn(t)}});const i=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});n.flipped=!e,n.start(i),document.body.appendChild(n)}();else{const t=new p;document.body.appendChild(t)}}),window.addEventListener(y.frameEvent,async function(t){N&&(N.remove(),N=null);const{detail:e}=t,{imgData:n}=e,a=await i(n);for(const t of a){if(x.has(t.rawValue))continue;x.add(t.rawValue);const e=new d;e.src=t.rawValue,D().appendChild(e)}});const R=new b;R.useEvents=!0,R.addDetector(I),R.detect()}();